{% load static %}
{% include 'header.html' %}

<!-- Page Header Start -->
<div class="container-fluid page-header mb-5 p-0" style="background-image: url(img/carousel-bg-2.jpg);">
    <div class="container-fluid page-header-inner py-5">
        <div class="container text-center">
            <h1 class="display-3 text-white mb-3 animated slideInDown">Services</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb justify-content-center text-uppercase">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Pages</a></li>
                    <li class="breadcrumb-item text-white active" aria-current="page">Services</li>
                </ol>
            </nav>
        </div>
    </div>
</div>
<!-- Page Header End -->


<!-- Service Start -->
<div class="container-xxl service py-5">
    <div class="container">
        <div class="text-center wow fadeInUp" data-wow-delay="0.1s">

            <h1 class="mb-5">Recommended Services</h1>
        </div>

        <div class="row g-4 wow fadeInUp" data-wow-delay="0.3s">
            <div class="col-lg-12"
                style="display: flex;row-gap: 25px;justify-content: space-between;flex-wrap: wrap;padding-right: 0;padding-left: 0;">

                {% for key in recomended %}
                <div class="wrapper" onmouseout="resetCardStyle(this)" onmouseover="changeCardStyle(this)">
                    <div class="head"></div>
                    <div class="blue"></div>
                    <div class="logo"
                        style="background-image: url({% static '/image/service_list_image/' %}{{key.2}});">
                    </div>

                    <div class="content">
                        <a href="/view-service/{{ key.0 }}" id="view_ser_btn" class="btn btn-md btn-success"
                            style="display: none;">View</a>
                        <h4 class="text-light">{{ key.3 }}</h4>
                        <p class="">Bussiness : {{ key.6 }}</p>
                        <p>Place : {{ key.8 }},{{ key.9 }}</p>
                        <p>Phone : {{ key.7 }}</p>
                    </div>
                    <div class="bottom">Estimated Cost : ₹{{ key.4 }}</div>
                </div>


                {% endfor %}


            </div>

        </div>
    </div>
</div>
<!-- Service End -->

<div class="container-xxl service py-5">
    <div class="container">
        <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
            <h6 class="text-primary text-uppercase">// Our Services //</h6>
            <h1 class="mb-5">Explore Our Services</h1>
        </div>
        <div class="row g-4 wow fadeInUp mb-4" data-wow-delay="0.3s">
            <div class="col-md-3">
                <div class="form-floating">
                    <input onchange="invokeSearch($(this).val())" oninput="invokeSearch($(this).val())" type="text"
                        class="form-control" id="name" placeholder="Your passowrd">
                    <label for="name">Search...</label>
                </div>
            </div>

            <div class="col-md-3">
                <div class="form-floating">
                    <select name="cars" class="form-control" id="cars" onchange="getCityData($(this).val())">
                        <option disabled selected value="">Select state</option>
                        {% for data in states %}
                        <option value='{{data.0}}'>{{data.1}}</option>
                        {% endfor %}
                    </select>
                    <label for="name">Choose State</label>
                </div>
            </div>

            <div class="col-md-3">
                <div class="form-floating">
                    <select name="city" class="form-control" id="city">
                        <option disabled selected value="">Select City</option>
                    </select>
                    <label for="name">Choose City</label>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-floating">
                    <div class="col-12">
                        <button class="btn btn-primary w-100 py-3" type="submit"
                            onclick="invokeGetServiceByPlaces()">Find Services</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-4 wow fadeInUp" data-wow-delay="0.3s">
            <div class="col-lg-12" id="service_show_elm"
                style="display: flex;row-gap: 25px;justify-content: space-between;flex-wrap: wrap;padding-right: 0;padding-left: 0;">
                {% for key in payload %}
                <div class="wrapper" onmouseout="resetCardStyle(this)" onmouseover="changeCardStyle(this)">
                    <div class="head"></div>
                    <div class="blue"></div>
                    <div class="logo"
                        style="background-image: url({% static '/image/service_list_image/' %}{{key.2}});">
                    </div>
                    <div class="content">
                        <a href="/view-service/{{ key.0 }}" id="view_ser_btn" class="btn btn-md btn-success"
                            style="display: none;">View</a>
                        <h4 class="text-light">{{ key.3 }}</h4>
                        <p class="">Bussiness : {{ key.6 }}</p>
                        <p>Place : {{ key.8 }},{{ key.9 }}</p>
                        <p>Phone : {{ key.7 }}</p>
                    </div>
                    <div class="bottom">Estimated Cost : ₹{{ key.4 }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<!-- Service End -->


<!-- Booking Start -->
<!-- <div class="container-fluid bg-secondary booking my-5 wow fadeInUp" data-wow-delay="0.1s">
    <div class="container">
        <div class="row gx-5">
            <div class="col-lg-6 py-5">
                <div class="py-5">
                    <h1 class="text-white mb-4">Certified and Award Winning Car Repair Service Provider</h1>
                    <p class="text-white mb-0">Eirmod sed tempor lorem ut dolores. Aliquyam sit sadipscing kasd ipsum.
                        Dolor ea et dolore et at sea ea at dolor, justo ipsum duo rebum sea invidunt voluptua. Eos vero
                        eos vero ea et dolore eirmod et. Dolores diam duo invidunt lorem. Elitr ut dolores magna sit.
                        Sea dolore sanctus sed et. Takimata takimata sanctus sed.</p>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="bg-primary h-100 d-flex flex-column justify-content-center text-center p-5 wow zoomIn"
                    data-wow-delay="0.6s">
                    <h1 class="text-white mb-4">Book For A Service</h1>
                    <form>
                        <div class="row g-3">
                            <div class="col-12 col-sm-6">
                                <input type="text" class="form-control border-0" placeholder="Your Name"
                                    style="height: 55px;">
                            </div>
                            <div class="col-12 col-sm-6">
                                <input type="email" class="form-control border-0" placeholder="Your Email"
                                    style="height: 55px;">
                            </div>
                            <div class="col-12 col-sm-6">
                                <select class="form-select border-0" style="height: 55px;">
                                    <option selected>Select A Service</option>
                                    <option value="1">Service 1</option>
                                    <option value="2">Service 2</option>
                                    <option value="3">Service 3</option>
                                </select>
                            </div>
                            <div class="col-12 col-sm-6">
                                <div class="date" id="date1" data-target-input="nearest">
                                    <input type="text" class="form-control border-0 datetimepicker-input"
                                        placeholder="Service Date" data-target="#date1" data-toggle="datetimepicker"
                                        style="height: 55px;">
                                </div>
                            </div>
                            <div class="col-12">
                                <textarea class="form-control border-0" placeholder="Special Request"></textarea>
                            </div>
                            <div class="col-12">
                                <button class="btn btn-secondary w-100 py-3" type="submit">Book Now</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div> -->
<!-- Booking End -->

{% include 'footer.html' %}

<script>
    function changeCardStyle(element) {
        element.style.opacity = 0.5
        element.childNodes[7].childNodes[1].style.display = 'block'

    }
    function resetCardStyle(element) {
        element.style.opacity = 1
        element.childNodes[7].childNodes[1].style.display = 'none'
    }
    function changeCardStyle1(element) {
        element.style.opacity = 0.5
        element.childNodes[3].childNodes[0].style.display = 'block'

    }
    function resetCardStyle1(element) {
        element.style.opacity = 1
        element.childNodes[3].childNodes[0].style.display = 'none'
    }
    function getCityData(state_id) {
        if (state_id != '' || state_id != null) {
            invokeAjax({
                'stateID': state_id,
                'action': 3,
                'informAction': 0
            })
        }
    }
    function appendCityData(response) {
        $("#city").empty();
        $('#city').append('<option disabled selected>Select city</option>')
        if (response.status == 1) {
            let select_elem = document.getElementById('city');
            response.data.forEach(element => {
                let option_elem = document.createElement('option');
                // Add index to option_elem
                option_elem.value = element[0];
                // Add element HTML
                option_elem.textContent = element[1];
                // Append option_elem to select_elem
                select_elem.appendChild(option_elem);
            });
        } else {
            $('#city').append('<option>Empty</option>')
        }
    }
    function invokeGetServiceByPlaces() {
        cityID = $('#city :selected').val();
        if (typeof (cityID) != 'undefined') {
            invokeAjax({
                'cityID': cityID,
                'action': 5,
                'informAction': 2
            })
        } else {
            swal('Error', "Please choose a city", 'info', 'close');
        }
    }
    function invokeAjax(data) {
        $.ajax({
            headers: { "X-CSRFToken": '{{csrf_token}}' },
            type: "POST",
            url: "/api-register/",
            data: data,
            success: (response) => {
                response = JSON.parse(response)
                if (data.informAction == 0) {
                    appendCityData(response)
                } else if (data.informAction == 1) {
                    appendSearchData(response)
                } else if (data.informAction == 2) {
                    appendSearchData(response)
                }
            },
        });
    }
    function appendSearchData(response) {
        $("#service_show_elm").empty();
        if (response.status == 1) {
            let innerElm = '';
            response.data.forEach(element => {
                innerElm += '<div class="wrapper" onmouseout="resetCardStyle1(this)" onmouseover="changeCardStyle1(this)"><div class="head"></div><div class="blue"></div><div class="logo"style="background-image: url({%  static ' / image / service_list_image / ' %}' + element[2] + ');"></div><div class="content"><a href="/view-service/' + element[0] + '" id="view_ser_btn" class="btn btn-md btn-success" style="display: none;">View</a><h4 class="text-light">' + element[3] + '</h4><p>Bussiness : ' + element[6] + '</p><p>Place : ' + element[8] + ',' + element[9] + '</p><p>Phone : ' + element[7] + '</p></div><div class="bottom">Estimated Cost : ₹' + element[4] + '</div></div >';
            });
            $("#service_show_elm").append(innerElm);
        } else {

            $("#service_show_elm").append('<p class="text-danger">' + response.msg + '</p>');
        }

    }
    function invokeSearch(text) {
        if (text != '' || text != null) {
            invokeAjax({
                'keyword': text,
                'action': 4,
                'informAction': 1
            })
        }
    }
    function swal(title, text, icon, btnText) {
        Swal.fire({
            'title': title,
            'text': text,
            'icon': icon,
            'confirmButtonText': btnText
        })
    }
</script>

<style>
    .wrapper p{
        margin-top: 0 !important;
       
        margin-bottom: 5px !important;
    }
    .wrapper {
        width: 300px;
        height: 450px;
        background-color: rgb(255, 255, 255);
        text-align: left;
        position: relative;
        transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;
        border-radius: 3px;
        overflow: hidden;
        box-shadow: rgb(31 31 31 / 12%) 0px 1px 6px, rgb(31 31 31 / 12%) 0px 1px 4px;
    }

    .head {
        width: 100%;
        height: 200px;
        background-image: url('{% static "img/service-2.jpg" %}');
        background-color: rgb(130, 168, 225);
        background-repeat: no-repeat;
        background-position: center center;
        background-size: cover;
    }

    .blue {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 152px;
        background-color: #D81324;
        transform: skewY(-13deg);
    }

    .logo {
        position: absolute;
        top: 80px;
        left: 25px;
        width: 100px;
        height: 100px;
        background-origin: content-box;

        border: 1px solid rgb(225, 225, 225);
        border-radius: 3px;
        z-index: 1;
        background-color: rgb(255, 255, 255);
        background-size: contain;
        background-position: center center;
        background-repeat: no-repeat;
    }

    .content {
        position: absolute;
        top: 190px;
        left: 25px;
        color: rgb(255, 255, 255);
    }

    .content h3 {
        margin: 0px;
        font-size: 10px !important;
        font-weight: 700;
        line-height: 1.5rem;
    }

    .content p {
        font-size: 0.875rem;
        font-weight: normal;
        line-height: 1.5rem;
    }

    .content button {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
    }

    .bottom {
        width: 100%;
        position: absolute;
        bottom: 4px;
        padding: 0.75rem 1.5rem;
        color: rgb(245, 247, 250);
        font-size: 1rem;
        line-height: 1.125rem;
        text-transform: uppercase;
        font-weight: bold;
        font-family: OpenSans-Bold, OpenSans, Arial, sans-serif;
    }
</style>